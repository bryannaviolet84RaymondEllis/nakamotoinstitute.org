[
    {
        "thread_id": 123,
        "name": "satoshi",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=3",
        "subject": "JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg4059#msg4059",
        "date": "July 18, 2010, 08:49:22 PM",
        "content": "<div class=\"post\">I uploaded to SVN my changes to add a password to JSON-RPC. \u00a0If you're set up to build, please test it.<br/><br/>The -server switch is replaced with -rpcpw=&lt;password&gt;, which is also used with bitcoind.<br/>bitcoin -rpcpw=&lt;password&gt; \u00a0 \u00a0-- runs with JSON-RPC port open<br/>bitcoind -rpcpw=&lt;password&gt; \u00a0 -- daemon with password<br/><br/>If you have a better idea for the switch name, let me know, but keep in mind there will eventually be a password for encrypting the database too.\u00a0 I'm not sure but I think they may want to use different passwords for the two.<br/><br/>It gives a warning if you don't set a password.<br/><br/>All commands now require the password as the first parameter. \u00a0It'll tell you that if you run \"bitcoind help\".<br/><br/>The central code:<br/><br/>\u00a0\u00a0// Check password<br/>\u00a0\u00a0if (params.size() &lt; 1 || params[0].type() != str_type)<br/>\u00a0\u00a0 \u00a0 \u00a0throw runtime_error(\"First parameter must be the password.\");<br/>\u00a0\u00a0if (params[0].get_str() != strRPCPassword)<br/>\u00a0\u00a0{<br/>\u00a0\u00a0 \u00a0 \u00a0if (strRPCPassword.size() &lt; 15)<br/>\u00a0\u00a0 \u00a0 \u00a0 \u00a0 \u00a0Sleep(50);<br/>\u00a0\u00a0 \u00a0 \u00a0begin = strRequest.end();<br/>\u00a0\u00a0 \u00a0 \u00a0printf(\"ThreadRPCServer incorrect password attempt\\n\");<br/>\u00a0\u00a0 \u00a0 \u00a0throw runtime_error(\"Incorrect password.\");<br/>\u00a0\u00a0}<br/><br/>Any comments on these decisions?<br/><br/>1) if (strRPCPassword.size() &lt; 15) Sleep(50); \u00a0-- this means if it's a short password, it'll wait 50ms after each attempt. \u00a0This might be used as a DoS attack, but I figured if it's a short password, it's more important to protect against brute force password scan. \u00a0This may tell outsiders whether the password is less than 15 characters, but less than 15 isn't all that noteworthy, most passwords are less than 15. \u00a0If you want to close the DoS possibility, just use a password 15 characters or longer.<br/><br/>2) begin = strRequest.end(); \u00a0-- if it's a single request with multiple invocations, I throw away the rest if one has a bad password. \u00a0This is so you can't stuff it with millions of password attempts in one packet. \u00a0What do you think, is this the right thing to do? \u00a0(multiple invocation is probably almost never used anyway)<br/><br/>I also fixed the two duplicated commands listed in the help:<br/><br/>getaddressesbylabel &lt;pw&gt; &lt;label&gt;<br/>getbalance &lt;pw&gt;<br/>getblockcount &lt;pw&gt;<br/>getblocknumber &lt;pw&gt;<br/>getconnectioncount &lt;pw&gt;<br/>getdifficulty &lt;pw&gt;<br/>getgenerate &lt;pw&gt;<br/>getinfo &lt;pw&gt;<br/>getlabel &lt;pw&gt; &lt;bitcoinaddress&gt;<br/>getnewaddress &lt;pw&gt; [label]<br/>getreceivedbyaddress &lt;pw&gt; &lt;bitcoinaddress&gt; [minconf=1]<br/>getreceivedbylabel &lt;pw&gt; &lt;label&gt; [minconf=1]<br/>help &lt;pw&gt;<br/>listreceivedbyaddress &lt;pw&gt; [minconf=1] [includeempty=false]<br/>listreceivedbylabel &lt;pw&gt; [minconf=1] [includeempty=false]<br/>sendtoaddress &lt;pw&gt; &lt;bitcoinaddress&gt; &lt;amount&gt; [comment] [comment-to]<br/>setgenerate &lt;pw&gt; &lt;generate&gt; [genproclimit]<br/>setlabel &lt;pw&gt; &lt;bitcoinaddress&gt; &lt;label&gt;<br/>stop &lt;pw&gt;<br/></div>",
        "post_num": 1,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "laszlo",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=143",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg4116#msg4116",
        "date": "July 19, 2010, 12:44:52 AM",
        "content": "<div class=\"post\">I guess it's ok for remotely doing it but if your concern is that someone else on the same unix machine can steal your bitcoins this still doesn't help because they can see your command line in /proc, top, ps etc.\u00a0 It could read the password on stdin or use readline or something, to guard against that particular thing at least.\u00a0 Allowing it to be passed on the command line is not good, in my opinion.<br/><br/>Even better might be to use a key file, then you can use unix permissions to make it readable to only that user, kind of like ssh does.. then the bitcoind could have an 'authorized_keys' file with the public keys.\u00a0 Anyway I don't mean to be an ass but the command line thing is just a false sense of security.</div>",
        "post_num": 2,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "martin",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=310",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg4131#msg4131",
        "date": "July 19, 2010, 01:25:12 AM",
        "content": "<div class=\"post\">I'm afraid I have to agree with laszlo here, using a certificate/keyfile would be far more secure. Saying that, thanks for adding some security to the JSON api <img alt=\"Cheesy\" border=\"0\" src=\"https://bitcointalk.org/Smileys/default/cheesy.gif\"/></div>",
        "post_num": 3,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "satoshi",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=3",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg4169#msg4169",
        "date": "July 19, 2010, 04:43:13 AM",
        "content": "<div class=\"post\">Right, that is quite a bit better.\u00a0 <br/><br/>Can you give me any examples of other stuff that does it that way?\u00a0 (and what the command line looks like)<br/><br/>The main change you're talking about here is instead of -rpcpw= when you start bitcoind, you'd use a switch that specifies a text file to go and read it from, right?\u00a0 (any ideas what I should name the switch?)</div>",
        "post_num": 4,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "Gavin Andresen",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=224",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg4215#msg4215",
        "date": "July 19, 2010, 12:02:39 PM",
        "content": "<div class=\"post\">The Bitcoin Faucets (production and TEST) are now running with this change.<br/><br/>I was confused for a bit because the password is given LAST on the command line, but FIRST in the JSON-RPC params list.\u00a0 I agree that reading the command-line password from a file would be more convenient and more secure.<br/><br/>I'll try to do some research on how other projects tackle JSON-RPC authentication.<br/></div>",
        "post_num": 5,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "Gavin Andresen",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=224",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg4221#msg4221",
        "date": "July 19, 2010, 12:30:03 PM",
        "content": "<div class=\"post\">The Transmission BitTorrent client does authenticated JSON-RPC; see \"Remote Control\" section of:<br/>\u00a0<a href=\"https://trac.transmissionbt.com/wiki/ConfigurationParameters\">https://trac.transmissionbt.com/wiki/ConfigurationParameters</a><br/><br/>E.g. setting.json file might look like:<br/><div class=\"codeheader\">Code:</div><div class=\"code\">{<br/>\u00a0 \u00a0 \"rpc-enabled\":1<br/>\u00a0 \u00a0 \"rpc-authentication-required\": 1,<br/>\u00a0 \u00a0 \"rpc-password\": \"xxxxxxxxxx\",<br/>\u00a0 \u00a0 \"rpc-port\": 9091,<br/>\u00a0 \u00a0 \"rpc-username\": \"xxxxxxxxxx\",<br/>\u00a0 \u00a0 \"rpc-whitelist-enabled\":1<br/>\u00a0 \u00a0 \"rpc-whitelist\":\"127.0.0.1,192.168.*.*\"<br/>}</div><br/>It uses <a href=\"http://en.wikipedia.org/wiki/Basic_access_authentication\">HTTP 'basic' authentication</a> (Authorization: basic base64(username:password) in the HTTP headers).<br/><br/></div>",
        "post_num": 6,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "Gavin Andresen",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=224",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg4248#msg4248",
        "date": "July 19, 2010, 03:20:35 PM",
        "content": "<div class=\"post\">After further research...\u00a0 I think the Transmission approach, combined with the existing \"only allow connections from 127.0.0.1\" is a good short/medium-term solution.<br/><br/>Putting the username:password in a settings.json file in the Bitcoin directory aught to work nicely (since Bitcoin can already parse JSON).\u00a0 And keeping the authentication stuff off the command line and in the HTTP headers instead of the JSON request params is nice and clean.<br/><br/>Long term, the \"right\" way to do authenticated, secure JSON-RPC is with client-side certificates and https.\u00a0 \u00a0 But that looks like it would be a lot of work to implement and a <a href=\"http://it.toolbox.com/blogs/securitymonkey/howto-securing-a-website-with-client-ssl-certificates-11500\">big learning curve</a> for users to figure out how to generate client-side certificates and how to get both sides of the JSON-RPC connection using them.\u00a0 \u00a0And I'm not even certain a full-blown client certificate solution would solve the problem of malicious Javascript making JSON-RPC requests via XMLHttpRequests to localhost; if the user installed the client certificate in the browser (because maybe there was a nifty JSON-RPC-powered web front-end to controlling Bitcoin), would the browser automatically send the client certificate if a malicious website made requests?<br/></div>",
        "post_num": 7,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "satoshi",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=3",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg4268#msg4268",
        "date": "July 19, 2010, 04:20:50 PM",
        "content": "<div class=\"post\">So you drop a settings file in the ~/.bitcoin directory, that sounds better. \u00a0In the \"no password is set\" warning, it could tell you where the file is and what to do.<br/><br/>What is the most popular and common settings file format?<br/><br/>HTTP basic authentication should be considered. \u00a0In actual practice though, it's more work for web developers to figure out how to specify the password through some extra parameter in the HTTP or JSON-RPC wrapper than to just stick an extra parameter at the beginning of the parameter list. \u00a0What do you think? \u00a0Does HTTP basic authentication get us any additional benefits?\u00a0 Moving it off the parameter list but then you still have to specific it in a more esoteric place I'm not sure is a net win. <br/><br/><div class=\"quoteheader\"><a href=\"https://bitcointalk.org/index.php?topic=461.msg4215#msg4215\">Quote from: gavinandresen on July 19, 2010, 12:02:39 PM</a></div><div class=\"quote\">I was confused for a bit because the password is given LAST on the command line, but FIRST in the JSON-RPC params list. \u00a0I agree that reading the command-line password from a file would be more convenient and more secure.<br/></div>You're also confusing me, what do you mean? \u00a0Did I do something unintended?</div>",
        "post_num": 8,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "Gavin Andresen",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=224",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg4284#msg4284",
        "date": "July 19, 2010, 04:58:48 PM",
        "content": "<div class=\"post\"><div class=\"quoteheader\"><a href=\"https://bitcointalk.org/index.php?topic=461.msg4268#msg4268\">Quote from: satoshi on July 19, 2010, 04:20:50 PM</a></div><div class=\"quote\">So you drop a settings file in the ~/.bitcoin directory, that sounds better. \u00a0In the \"no password is set\" warning, it could tell you where the file is and what to do.<br/>What is the most popular and common settings file format?<br/></div>You ask hard questions!\u00a0 Most common: probably <a href=\"http://en.wikipedia.org/wiki/INI_file\">Windows INI</a> files, because Windows is most common OS.<br/><br/>I'd lobby for using JSON; it's (mostly) a subset of YAML (which is a common choice for config files), so any JSON or YAML parser will read it.<br/><div class=\"quoteheader\">Quote</div><div class=\"quote\">HTTP basic authentication should be considered. \u00a0In actual practice though, it's more work for web developers to figure out how to specify the password through some extra parameter in the HTTP or JSON-RPC wrapper than to just stick an extra parameter at the beginning of the parameter list. \u00a0What do you think? \u00a0Does HTTP basic authentication get us any additional benefits?<br/></div>I think the only big advantage is that it keeps authentication where it belongs in the transport layer, so if, in the future, you <b>do</b> want to go with full-fledged HTTPS with certificates the API doesn't have to change.<br/><div class=\"quoteheader\">Quote</div><div class=\"quote\"><div class=\"quoteheader\"><a href=\"https://bitcointalk.org/index.php?topic=461.msg4215#msg4215\">Quote from: gavinandresen on July 19, 2010, 12:02:39 PM</a></div><div class=\"quote\">I was confused for a bit because the password is given LAST on the command line, but FIRST in the JSON-RPC params list. \u00a0I agree that reading the command-line password from a file would be more convenient and more secure.<br/></div>You're also confusing me, what do you mean? \u00a0Did I do something unintended?<br/></div>No, I just confused \"command\" with \"parameter\", and did this:<br/><br/><div class=\"codeheader\">Code:</div><div class=\"code\">&gt; bitcoind help<br/>error: First parameter must be the password.<br/>&gt; bitcoind &lt;my password&gt; help<br/>error: unknown command: &lt;my password&gt;<br/>&gt;bitcoind help &lt;my password&gt;<br/>\u00a0... that works.<br/></div><br/></div>",
        "post_num": 9,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "Vasili Sviridov",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=446",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg4295#msg4295",
        "date": "July 19, 2010, 05:23:28 PM",
        "content": "<div class=\"post\">Should bitcoind be more of a system-wide daemon? With PAM authentication and support for all system users, not just the one running it?<br/>Like scanning /home/*/.bitcoin folders for a wallet file and provide access by both username and system password...</div>",
        "post_num": 10,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "laszlo",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=143",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg4380#msg4380",
        "date": "July 19, 2010, 10:53:12 PM",
        "content": "<div class=\"post\">If you're using another JSON-RPC client that you wrote you can take care to protect the password, but using the bitcoin binary as the client and passing the password on the command line has the same issue as starting the daemon with it.\u00a0 It's still visible to every user that way.<br/><br/>So both the server and the client mode invocation need to use the file and not accept the password on the command line.\u00a0 Generally programs like this refuse to start if the mode on the file isn't 600 or something like that, because that means other users can read it.</div>",
        "post_num": 11,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "satoshi",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=3",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg4577#msg4577",
        "date": "July 21, 2010, 12:05:20 AM",
        "content": "<div class=\"post\">Still need to know what's the most typical settings file format on Linux.\u00a0 Is there a standard file extension?\u00a0 I've never seen a settings file using JSON, and it doesn't look very human friendly with everything required to be in quotes.\u00a0 I think what I usually see is like:<br/># comment<br/>setting=value<br/><br/>Is there a settings file thing in Boost?<br/><br/>When you're using bitcoind to issue commands from the command line as a client, can we have it get the password from the settings file then too?<br/><br/>Gavin pointed out I forgot to increment the column of numbers in CommandLineRPC, so the current -rpcpw= implementation doesn't work right from the command line with non-string parameters.\u00a0 (JSON-RPC is fine)\u00a0 Still under construction.</div>",
        "post_num": 12,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "martin",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=310",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg4582#msg4582",
        "date": "July 21, 2010, 12:30:26 AM",
        "content": "<div class=\"post\">You could do worse than using <a href=\"http://www.yaml.org/spec/1.2/spec.html\">yaml</a> for the settings</div>",
        "post_num": 13,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "satoshi",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=3",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg4646#msg4646",
        "date": "July 21, 2010, 05:51:34 AM",
        "content": "<div class=\"post\">I was researching config file formats, here's a comparison.<br/><br/>YAML is massive. \u00a0I'm not sure there's a lightweight easy to build library we can integrate into our project. \u00a0Seems overkill.<br/><br/>JSON is tempting and I'm inclined to like it, but two main sticking points:<br/>1) No comments! \u00a0How can you have a config file where you can't comment out a line to disable it?<br/>2) Not very user friendly to have to \"quote\" all the strings, including the keys, and also have to remember the comma at the end of lines.<br/>{<br/>\u00a0\u00a0 \u00a0\"key\" : \"value\",<br/>}<br/><br/>I suppose we could easily preprocess JSON reading the config file one line at a time, truncate the lines at any # character (and/or \"//\"?), concatenate them into a string and pass it to JSON, so you could go:<br/># comment<br/>\"key\" : \"value\", \u00a0 # still have to remember the comma <br/>\"key2\" : \"value\", \u00a0 // comment like this or both<br/><br/>Boost has boost::program_options.<br/><br/>We could read lines ourselves and feed them into a map&lt;string, string&gt; mapConfig.<br/><br/>while (!eof)<br/>\u00a0\u00a0read line<br/>\u00a0\u00a0if '#' found, truncate line<br/>\u00a0\u00a0split line at first ':' -&gt; key, value<br/>\u00a0\u00a0mapConfig.insert(key, value)<br/><br/>If we use the syntax:<br/># comment<br/>key : value<br/><br/>...and don't allow whitespace indenting before the keys, I guess we would be a subset of YAML and could switch to YAML someday if we need more complexity. <br/><br/>If we go with self parsed, that doesn't mean we can't use JSON on particular parameter values as needed. \u00a0If an option needs a list or more structured data, it could always parse its value as json:<br/>key : [\"item1\", \"item2\", \"item3\"]<br/><br/>Although it has to be all on one line then.<br/><br/>I guess I'm leaning towards self parsed mapConfig:<br/># comment<br/>key : value<br/></div>",
        "post_num": 14,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "lachesis",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=237",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg4660#msg4660",
        "date": "July 21, 2010, 06:52:43 AM",
        "content": "<div class=\"post\">The simplest Linux config files typically have formats that look something like this:<br/><div class=\"codeheader\">Code:</div><div class=\"code\"># how often (in minutes) data is saved when all interface are offline<br/>OfflineSaveInterval 30<br/><br/># force data save when interface status changes (1 = enabled, 0 = disabled)<br/>SaveOnStatusChange 1<br/><br/># file used for logging if UseLogging is set to 1<br/>LogFile \"/var/log/vnstat.log\"<br/><br/># file used as daemon pid / lock file<br/>PidFile \"/var/run/vnstat.pid\"</div>The standard extension, if there is one, is .conf. Hash (#) is the most common comment character by far. Semicolon (<img alt=\"Wink\" border=\"0\" src=\"https://bitcointalk.org/Smileys/default/wink.gif\"/> and C-style comments crop up too.<br/><br/>I think a good, human-manipulatable config file that ISN'T part of the wallet would be a big step forward. There are a lot of options that are currently specified on the command line (noirc, for example, or -minimizetotray) which might be better specified in a config file.</div>",
        "post_num": 15,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "martin",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=310",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg4680#msg4680",
        "date": "July 21, 2010, 08:50:40 AM",
        "content": "<div class=\"post\">Out of those options Satoshi presented, I'd go with the self parsed file with the key/value separator character being a space like lachesis suggested, especially if that's the typical format for at least one OS.</div>",
        "post_num": 16,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "Gavin Andresen",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=224",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg4709#msg4709",
        "date": "July 21, 2010, 12:11:10 PM",
        "content": "<div class=\"post\">I think there's no such thing a a \"typical\" settings file on Linux!<br/><br/>I just did a quick survey of 20 .conf files in /etc on my debian system, and found:<br/>\u00a01 file used \"key value\"<br/>\u00a05 used \"key=value\"\u00a0 (actually, a couple were\u00a0 \"key = value\", allowing whitespace around the \"=\")<br/>\u00a014 did their own thing.<br/><br/>The 14 that did their own thing were all over the map; from one-value-per-line to \"key:value\" to full-blown XML.\u00a0 # is<br/>the universal comment character in the Linux world.<br/><br/>My vote would be for:<br/><br/># comment<br/>key1=value1<br/><br/></div>",
        "post_num": 17,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "satoshi",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=3",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg4758#msg4758",
        "date": "July 21, 2010, 04:07:57 PM",
        "content": "<div class=\"post\"><div class=\"quoteheader\"><a href=\"https://bitcointalk.org/index.php?topic=461.msg4709#msg4709\">Quote from: gavinandresen on July 21, 2010, 12:11:10 PM</a></div><div class=\"quote\">I just did a quick survey of 20 .conf files in /etc on my debian system, and found:<br/>\u00a01 file used \"key value\"<br/>\u00a05 used \"key=value\"\u00a0 <br/></div>Thanks for that survey!<br/><br/>I find \"key value\" a little unnatural.\u00a0 There ought to be a more definite separator between key and value that suggests assignment.\u00a0 The space people may just be getting lazy using their language's split function.<br/>key=some full sentence with spaces in it.\u00a0 # seems more clear<br/>key some full sentence with spaces in it.\u00a0 # than this<br/><br/>Allright then, lets go with self-parsed mapConfig, syntax:<br/># comment<br/>key=value<br/><br/>file extension .conf.\u00a0 What's the filename, is it ~/.bitcoin/settings.conf or ~/.bitcoin/bitcoin.conf or what?\u00a0 \u00a0<br/><br/>I think we better strip whitespace at the beginning and end of the key and the value.<br/># user who likes column formatted <br/>k\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 = value<br/>key\u00a0 \u00a0 \u00a0 \u00a0 \u00a0= value<br/>longerkey =\u00a0 \u00a0this sentence would be this\u00a0 \u00a0 # \"this sentence would be this\"<br/>\u00a0 \u00a0 \u00a0 \u00a0 key = value\u00a0 \u00a0# guess this is ok too<br/>\u00a0 nextkey = value<br/>\u00a0 \u00a0 \u00a0 right = justified<br/><br/>The normal syntax should be \"key=value\", but you can't blame people for the occasional \"key = value\".</div>",
        "post_num": 18,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "satoshi",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=3",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg4775#msg4775",
        "date": "July 21, 2010, 05:31:09 PM",
        "content": "<div class=\"post\">boost::program_options has the same \"key=value\" format.\u00a0 Gavin pointed out we can use it in a simple way as a parser without getting into all the esoteric c++ syntax like typed value extraction.\u00a0 We can use more features if we want later.<br/><br/>Lets go ahead with HTTP basic authentication instead of password as a parameter.</div>",
        "post_num": 19,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "Gavin Andresen",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=224",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg4908#msg4908",
        "date": "July 22, 2010, 01:11:26 AM",
        "content": "<div class=\"post\">I volunteered to implement this, and made good progress today.\u00a0 Satoshi: I should have patches for you tomorrow.<br/><br/>Done: teach Bitcoin to read settings from {BITCOIN_DIR}/bitcoin.conf file, and added -conf=path_to_config_file.conf command-line option.\u00a0 <br/>Done: teach Bitcoin RPC to require HTTP Basic authentication, and reject requests with the wrong username/password.<br/><br/>TODO: teach Bitcoin command-line RPC to add the Authorization: header.\u00a0 You won't have to give the username/password when controlling bitcoin from the command line, it'll read them from the bitcoin.conf file and Do the Right Thing.<br/>TODO: dialog box or debug.log warning if no rpc.user/rpc.password is set, explaining how to set.<br/>TODO: limit password guessing attempts if the rpc.password is &lt; 15 characters long.<br/>TODO: update the JSON-RPC wiki page<br/><br/>After all that is done and I've sent patches to Satoshi, I'm going to add a couple more things to bitcoin.conf :<br/><br/>port=\u00a0 \u00a0# to set the listen port (override default 8333)<br/>rpc.port= # to set the JSON-RPC port (override default 8332)<br/><br/>With the existing -datadir option, that'll make it easier for me to run multiple bitcoins on one box.<br/></div>",
        "post_num": 20,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "lachesis",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=237",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg4913#msg4913",
        "date": "July 22, 2010, 01:27:46 AM",
        "content": "<div class=\"post\">Excellent Gavin. We should start a list of proposed config file options in this thread.<br/><br/>I, for one, suggest a <b>noirc</b> (off by default) option and a <b>minimizetotray</b> option, both of which would do the same thing as the command-line switches by the same name. That'll stop the hackery of launching my Bitcoin with -minimizetotray each time. Also, maybe -server and -daemon should get similar options?</div>",
        "post_num": 21,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "Gavin Andresen",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=224",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg4918#msg4918",
        "date": "July 22, 2010, 01:51:40 AM",
        "content": "<div class=\"post\">I've implemented it so that all the command-line options can also be specified in the bitcoin.conf file.<br/><br/>Options given on the command line override options in the conf file.\u00a0 But I need to do more testing, especially with the \"multiargs\" options like \"addnode\".<br/></div>",
        "post_num": 22,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "satoshi",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=3",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg4928#msg4928",
        "date": "July 22, 2010, 02:34:23 AM",
        "content": "<div class=\"post\"><div class=\"quoteheader\"><a href=\"https://bitcointalk.org/index.php?topic=461.msg4908#msg4908\">Quote from: gavinandresen on July 22, 2010, 01:11:26 AM</a></div><div class=\"quote\">TODO: dialog box or debug.log warning if no rpc.user/rpc.password is set, explaining how to set.<br/></div>In many of the contexts of this RPC stuff, you can print to the console with fprintf(stdout, like this:<br/>#if defined(__WXMSW__) &amp;&amp; wxUSE_GUI<br/>\u00a0 \u00a0 \u00a0 \u00a0 MyMessageBox(\"Warning: rpc password is blank, use -rpcpw=&lt;password&gt;\\n\", \"Bitcoin\", wxOK | wxICON_EXCLAMATION);<br/>#else<br/>\u00a0 \u00a0 \u00a0 \u00a0 fprintf(stdout, \"Warning: rpc password is blank, use -rpcpw=&lt;password&gt;\\n\");<br/>#endif</div>",
        "post_num": 23,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "Gavin Andresen",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=224",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg5296#msg5296",
        "date": "July 23, 2010, 03:11:45 PM",
        "content": "<div class=\"post\">I've updated the <a href=\"http://www.bitcoin.org/wiki/doku.php?id=api\">RPC wiki page</a> for how the password stuff will work in Bitcoin 0.3.3.<br/><br/>One nice side effect: you can prepare for the changes now; create a bitcoin.conf file with a username and password and modify your JSON-RPC code to do the HTTP Basic Authentication thing.\u00a0 Old code will just ignore the .conf file and the Authorization: HTTP header.<br/><br/>Question for everybody:\u00a0 should I add a section to the wiki page describing, in detail, how to do HTTP Basic authentication?\u00a0 PHP and Python make is really easy-- just use the <a href=\"http://user:pass@host:port/\">http://user:pass@host:port/</a> URL syntax.\u00a0 I don't want to just duplicate the HTTP Basic authentication Wikipedia page.<br/></div>",
        "post_num": 24,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "satoshi",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=3",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg5337#msg5337",
        "date": "July 23, 2010, 05:07:40 PM",
        "content": "<div class=\"post\"><div class=\"quoteheader\"><a href=\"https://bitcointalk.org/index.php?topic=461.msg5296#msg5296\">Quote from: gavinandresen on July 23, 2010, 03:11:45 PM</a></div><div class=\"quote\">Question for everybody:\u00a0 should I add a section to the wiki page describing, in detail, how to do HTTP Basic authentication?\u00a0 PHP and Python make is really easy-- just use the <a href=\"http://user:pass@host:port/\">http://user:pass@host:port/</a> URL syntax.<br/></div>Yes, I think that would be really good so each dev doesn't have to figure it out themselves.\u00a0 We need a simple example for each of Python, PHP and Java importing the json-rpc library and using it to do a getinfo or something, including doing the http authentication part.</div>",
        "post_num": 25,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "satoshi",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=3",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg5338#msg5338",
        "date": "July 23, 2010, 05:14:31 PM",
        "content": "<div class=\"post\">Gavin's changes look good.\u00a0 I think everything is complete.\u00a0 Here's a test build, please test it!<br/><br/><a href=\"http://www.bitcoin.org/download/bitcoin-0.3.2.5-win32.zip\">http://www.bitcoin.org/download/bitcoin-0.3.2.5-win32.zip</a><br/><a href=\"http://www.bitcoin.org/download/bitcoin-0.3.2.5-linux.tar.gz\">http://www.bitcoin.org/download/bitcoin-0.3.2.5-linux.tar.gz</a><br/></div>",
        "post_num": 26,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "Gavin Andresen",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=224",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg5342#msg5342",
        "date": "July 23, 2010, 05:56:33 PM",
        "content": "<div class=\"post\"><div class=\"quoteheader\"><a href=\"https://bitcointalk.org/index.php?topic=461.msg5337#msg5337\">Quote from: satoshi on July 23, 2010, 05:07:40 PM</a></div><div class=\"quote\">Yes, I think that would be really good so each dev doesn't have to figure it out themselves.\u00a0 We need a simple example for each of Python, PHP and Java importing the json-rpc library and using it to do a getinfo or something, including doing the http authentication part.<br/></div>OK, I did Python and PHP, and I added what I know about Java.\u00a0 Can somebody who has used Java JSON-RPC update the wiki page with a working example?<br/></div>",
        "post_num": 27,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "lachesis",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=237",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg5348#msg5348",
        "date": "July 23, 2010, 06:22:08 PM",
        "content": "<div class=\"post\">The password definitely shouldn't be required. Also, the new code chokes on \"rpcpassword=\". If there's no config file, the config file doesn't contain an rpcpassword line, or it contains \"rpcpassword=\", the password should be disabled.</div>",
        "post_num": 28,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "Gavin Andresen",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=224",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg5357#msg5357",
        "date": "July 23, 2010, 06:51:34 PM",
        "content": "<div class=\"post\"><div class=\"quoteheader\"><a href=\"https://bitcointalk.org/index.php?topic=461.msg5348#msg5348\">Quote from: lachesis on July 23, 2010, 06:22:08 PM</a></div><div class=\"quote\">The password definitely shouldn't be required.<br/></div>I strongly disagree; software should be secure by default, and running bitcoind without a password (or bitcoin -server) is definitely NOT secure.<br/><br/>I just don't see somebody saying \"Man, Bitcoin sucks because I have to add a password to a configuration file before running it as a daemon.\"\u00a0 I <b>can</b> see somebody saying \"Man, Bitcoin sucks because I accidently ran it with the -server switch and somebody stole all my money.\"</div>",
        "post_num": 29,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "satoshi",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=3",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg5383#msg5383",
        "date": "July 23, 2010, 08:39:03 PM",
        "content": "<div class=\"post\">I don't think authentication should be disabled by default if there's no conf file or the config file doesn't contain \"rpcpassword\", but what if it contains \"rpcpassword=\"?<br/><br/>I can see both points.<br/><br/>What if the programmer can't figure out how to do HTTP authentication in their language (Fortran or whatever) or it's not even supported by their JSON-RPC library? \u00a0Should they be able to explicitly disable the password requirement?<br/><br/>OTOH, what if there's a template conf file, with<br/>rpcpassword= \u00a0# fill in a password here<br/><br/>There are many systems that don't allow you to log in without a password. \u00a0This forum, for instance. \u00a0Gavin's point seems stronger.<br/><br/>BTW, I haven't tested it, but I hope having rpcpassword= \u00a0in the conf file is valid. \u00a0It's only if you use -server or -daemon or bitcoind that it should fail with a warning. \u00a0If it doesn't need the password, it should be fine. \u00a0Is that right?</div>",
        "post_num": 30,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "Gavin Andresen",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=224",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg5390#msg5390",
        "date": "July 23, 2010, 09:18:05 PM",
        "content": "<div class=\"post\"><div class=\"quoteheader\"><a href=\"https://bitcointalk.org/index.php?topic=461.msg5383#msg5383\">Quote from: satoshi on July 23, 2010, 08:39:03 PM</a></div><div class=\"quote\">BTW, I haven't tested it, but I hope having rpcpassword= \u00a0in the conf file is valid. \u00a0It's only if you use -server or -daemon or bitcoind that it should fail with a warning. \u00a0If it doesn't need the password, it should be fine. \u00a0Is that right?<br/></div>Yes, that's right, rpcpassword is only required if you use -server or -daemon or bitcoind (I just tested to be sure).<br/><br/>RE: what if the programmer can't figure out how to make their legacy COBOL code do HTTP authentication?<br/>Then I think another config file setting to explicitly turn off RPC authentication would be better than a magical \"if you set a blank rpcpassword then that turns off authentication.\"\u00a0 \u00a0But I wouldn't implement that until somebody really does have a problem or until we have more than one way of doing the authentication (maybe https someday...).<br/><br/>lachesis: is supporting HTTP Basic Authentication a problem for you?<br/></div>",
        "post_num": 31,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "lachesis",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=237",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg5434#msg5434",
        "date": "July 24, 2010, 02:46:23 AM",
        "content": "<div class=\"post\">Gavin, no. I know my way around urllib2 so that's not a problem. I would like to see the option to disable password authentication in the bitcoin.conf. We really shouldn't be protecting (advanced) users from themselves.<br/><br/>I was just annoyed that to even start -server (albeit on my test client), I had to edit the config file and insert a password. I can always hack my version of Bitcoin to not require a password by default if that's what I want, but I don't like the fact that bitcoin completely fails to start when I put in \"rpcpassword=\" with -server. I think the right way to do it would be to warn users (perhaps with a popup box if the GUI is starting) but still start the other stuff, even if the RPC server won't start.<br/><br/>Running with a password only marginally improves the security for a lot of applications anyway, since that password will have to sit in an httpd-readable file for my web server to execute JSON-RPC commands. The only user that's ever been hacked on my server? httpd. It is an important step for machines with multiple users, though, as is allowing the port number to be changed.</div>",
        "post_num": 32,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "lachesis",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=237",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg5738#msg5738",
        "date": "July 25, 2010, 07:52:35 PM",
        "content": "<div class=\"post\">I found what appears to be a bug: with a long enough username and password combination, the base64 encoder in bitcoind produces authorization headers that look like this:<br/><div class=\"codeheader\">Code:</div><div class=\"code\">POST / HTTP/1.1<br/>User-Agent: json-rpc/1.0<br/>Host: 127.0.0.1<br/>Content-Type: application/json<br/>Content-Length: 40<br/>Accept: application/json<br/>Authorization: Basic YWJiYWJiYWFiYmE6aGVsbG93b3JsZGhlbGxvd29ybGRoZWxsb3dvcmxkaGVsbG93<br/>b3JsZGhlbGxvd29ybGRoZWxsb3dvcmxk<br/></div>It inserts a newline every 64 characters, which obviously breaks the Authorization header, so commands like \"bitcoin getinfo\" fail. The server still works fine with properly behaving clients.<br/><br/>This can be solved by removing the newlines (and maybe '\\r's) from result at the end of the Base64Encode function:<br/><div class=\"codeheader\">Code:</div><div class=\"code\">result.erase(std::remove(result.begin(), result.end(), '\\n'), result.end());<br/>result.erase(std::remove(result.begin(), result.end(), '\\r'), result.end());<br/></div>There's probably a more elegant solution, but that works for me. Here's a patch:<br/><a href=\"http://www.alloscomp.com/bitcoin/patches/bitcoin-svn-109-rpcbug-2010-07-25.patch\">http://www.alloscomp.com/bitcoin/patches/bitcoin-svn-109-rpcbug-2010-07-25.patch</a></div>",
        "post_num": 33,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "gazoakley",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=476",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg5741#msg5741",
        "date": "July 25, 2010, 08:08:02 PM",
        "content": "<div class=\"post\">Whilst putting some security in is a good idea, it appears the JSON-RPC PHP doesn't support basic HTTP authentication right now. It'd have to be hacked in. Is anyone else using similar libraries going to encounter the same problem?<br/><br/>Also, whilst we're on the subject is bitcoind only binding to the loopback interface?</div>",
        "post_num": 34,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "lachesis",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=237",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg5745#msg5745",
        "date": "July 25, 2010, 08:30:16 PM",
        "content": "<div class=\"post\"><div class=\"quoteheader\"><a href=\"https://bitcointalk.org/index.php?topic=461.msg5741#msg5741\">Quote from: gazoakley on July 25, 2010, 08:08:02 PM</a></div><div class=\"quote\">Whilst putting some security in is a good idea, it appears the JSON-RPC PHP doesn't support basic HTTP authentication right now. It'd have to be hacked in. Is anyone else using similar libraries going to encounter the same problem?<br/><br/>Also, whilst we're on the subject is bitcoind only binding to the loopback interface?<br/></div>The PHP library I'm using definitely supports HTTP Basic authentication. You just have to craft the URL right:<br/><a href=\"http://username:password@localhost:8332/\">http://username:password@localhost:8332/</a></div>",
        "post_num": 35,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "gazoakley",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=476",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg5748#msg5748",
        "date": "July 25, 2010, 08:34:53 PM",
        "content": "<div class=\"post\"><div class=\"quoteheader\"><a href=\"https://bitcointalk.org/index.php?topic=461.msg5745#msg5745\">Quote from: lachesis on July 25, 2010, 08:30:16 PM</a></div><div class=\"quote\"><div class=\"quoteheader\"><a href=\"https://bitcointalk.org/index.php?topic=461.msg5741#msg5741\">Quote from: gazoakley on July 25, 2010, 08:08:02 PM</a></div><div class=\"quote\">Whilst putting some security in is a good idea, it appears the JSON-RPC PHP doesn't support basic HTTP authentication right now. It'd have to be hacked in. Is anyone else using similar libraries going to encounter the same problem?<br/><br/>Also, whilst we're on the subject is bitcoind only binding to the loopback interface?<br/></div>The PHP library I'm using definitely supports HTTP Basic authentication. You just have to craft the URL right:<br/><a href=\"http://username:password@localhost:8332/\">http://username:password@localhost:8332/</a><br/></div><br/>Of course, you can specify the username and password as part of the URL <img alt=\"Cheesy\" border=\"0\" src=\"https://bitcointalk.org/Smileys/default/cheesy.gif\"/>. Think a BC or two is deserved for that one\u00a0<img alt=\"Smiley\" border=\"0\" src=\"https://bitcointalk.org/Smileys/default/smiley.gif\"/> - sent.</div>",
        "post_num": 36,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "lachesis",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=237",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg5751#msg5751",
        "date": "July 25, 2010, 08:39:51 PM",
        "content": "<div class=\"post\"><div class=\"quoteheader\"><a href=\"https://bitcointalk.org/index.php?topic=461.msg5748#msg5748\">Quote from: gazoakley on July 25, 2010, 08:34:53 PM</a></div><div class=\"quote\">Think a BC or two is deserved for that one\u00a0<img alt=\"Smiley\" border=\"0\" src=\"https://bitcointalk.org/Smileys/default/smiley.gif\"/> - sent.<br/></div>Thank you sir. <img alt=\"Smiley\" border=\"0\" src=\"https://bitcointalk.org/Smileys/default/smiley.gif\"/></div>",
        "post_num": 37,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "The Madhatter",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=14",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg5752#msg5752",
        "date": "July 25, 2010, 08:40:32 PM",
        "content": "<div class=\"post\">If you are using PHP+JSON+CURL you can easily specify the user/pass with a curl_setopt() line. The parameter is \"CURLOPT_USERPWD\".<br/><br/>Thanks for the basic auth patch. Before the patch I was using uid/gid firewall lines to limit the bitcoind to only my special users/IPs that ran various scraps of code on crontabs. I'll likely still leave those protections in and just add in the basic http auth as well. <img alt=\"Smiley\" border=\"0\" src=\"https://bitcointalk.org/Smileys/default/smiley.gif\"/><br/><br/></div>",
        "post_num": 38,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "BitLex",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=292",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg5753#msg5753",
        "date": "July 25, 2010, 08:45:38 PM",
        "content": "<div class=\"post\">i got some problems here too trying to get this run on PHP.<br/>so far i had no luck, neither the wiki-sample (jsonRPCClient trying to fopen(<a href=\"http://username:password@localhost:8332/\">http://username:password@localhost:8332/</a>)), nor my curl-sample (using setopt CURLOPT_HTTPAUTH, CURLAUTH_BASIC) seem to work.</div>",
        "post_num": 39,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "The Madhatter",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=14",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg5755#msg5755",
        "date": "July 25, 2010, 08:54:38 PM",
        "content": "<div class=\"post\">Hmm.. shouldn't it be using digest auth instead of basic auth?<br/><br/>I usually wrap everything into SSL or IPSec anyway, but digest auth might keep noobs from getting pwned so easily. <img alt=\"Tongue\" border=\"0\" src=\"https://bitcointalk.org/Smileys/default/tongue.gif\"/><br/><br/><br/></div>",
        "post_num": 40,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "lachesis",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=237",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg5756#msg5756",
        "date": "July 25, 2010, 09:00:05 PM",
        "content": "<div class=\"post\">Digest auth is a fair bit harder to implement on both the client and the server side. It _should_ be using SSL and client certificates, but that's just a major PITA. Either that, or unix sockets.</div>",
        "post_num": 41,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "The Madhatter",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=14",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg5759#msg5759",
        "date": "July 25, 2010, 09:05:43 PM",
        "content": "<div class=\"post\">Hmm... I implemented digest auth into a custom webserver I wrote a decade ago. From what I remember, it was fairly easy. However, client support back then was rather shoddy. It has improved a lot since then. <img alt=\"Smiley\" border=\"0\" src=\"https://bitcointalk.org/Smileys/default/smiley.gif\"/><br/><br/>Perhaps we could document a simple stunnel + bitcoin configuration on the wiki then? Under a section called \"Securely using bitcoind from remote\"?<br/><br/>Just offering my 2c as usual. <img alt=\"Tongue\" border=\"0\" src=\"https://bitcointalk.org/Smileys/default/tongue.gif\"/><br/><br/></div>",
        "post_num": 42,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "satoshi",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=3",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg5767#msg5767",
        "date": "July 25, 2010, 09:34:29 PM",
        "content": "<div class=\"post\"><div class=\"quoteheader\"><a href=\"https://bitcointalk.org/index.php?topic=461.msg5738#msg5738\">Quote from: lachesis on July 25, 2010, 07:52:35 PM</a></div><div class=\"quote\">I found what appears to be a bug: with a long enough username and password combination, the base64 encoder in bitcoind produces authorization headers that look like this:<br/><div class=\"codeheader\">Code:</div><div class=\"code\">...<br/>Authorization: Basic YWJiYWJiYWFiYmE6aGVsbG93b3JsZGhlbGxvd29ybGRoZWxsb3dvcmxkaGVsbG93<br/>b3JsZGhlbGxvd29ybGRoZWxsb3dvcmxk<br/></div>It inserts a newline every 64 characters, which obviously breaks the Authorization header, so commands like \"bitcoin getinfo\" fail. The server still works fine with properly behaving clients.<br/><br/>This can be solved by removing the newlines (and maybe '\\r's) from result at the end of the Base64Encode function:<br/><div class=\"codeheader\">Code:</div><div class=\"code\">result.erase(std::remove(result.begin(), result.end(), '\\n'), result.end());<br/>result.erase(std::remove(result.begin(), result.end(), '\\r'), result.end());<br/></div></div>+1 to you for having such a long password that you found this bug.<br/><br/>Uploaded to SVN as rev 110.<br/></div>",
        "post_num": 43,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "Gavin Andresen",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=224",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg5768#msg5768",
        "date": "July 25, 2010, 09:38:19 PM",
        "content": "<div class=\"post\"><div class=\"quoteheader\"><a href=\"https://bitcointalk.org/index.php?topic=461.msg5738#msg5738\">Quote from: lachesis on July 25, 2010, 07:52:35 PM</a></div><div class=\"quote\">I found what appears to be a bug: with a long enough username and password combination, the base64 encoder in bitcoind ... inserts a newline every 64 characters</div><br/>Great catch! \u00a0Simpler fix is to specify the BIO_FLAGS_BASE64_NO_NL in the rpc.cpp/EncodeBase64 function:<br/><div class=\"codeheader\">Code:</div><div class=\"code\">diff --git a/rpc.cpp b/rpc.cpp<br/>index 72bdc50..703b757 100644<br/>--- a/rpc.cpp<br/>+++ b/rpc.cpp<br/>@@ -765,13 +765,14 @@ string EncodeBase64(string s)<br/>\u00a0\u00a0 \u00a0 BUF_MEM *bptr;<br/>\u00a0<br/>\u00a0\u00a0 \u00a0 b64 = BIO_new(BIO_f_base64());<br/>+ \u00a0 \u00a0BIO_set_flags(b64, BIO_FLAGS_BASE64_NO_NL);<br/>\u00a0\u00a0 \u00a0 bmem = BIO_new(BIO_s_mem());<br/>\u00a0\u00a0 \u00a0 b64 = BIO_push(b64, bmem);<br/>\u00a0\u00a0 \u00a0 BIO_write(b64, s.c_str(), s.size());<br/>\u00a0\u00a0 \u00a0 BIO_flush(b64);<br/>\u00a0\u00a0 \u00a0 BIO_get_mem_ptr(b64, &amp;bptr);<br/>\u00a0<br/>- \u00a0 \u00a0string result(bptr-&gt;data, bptr-&gt;length-1);<br/>+ \u00a0 \u00a0string result(bptr-&gt;data, bptr-&gt;length);<br/>\u00a0\u00a0 \u00a0 BIO_free_all(b64);<br/>\u00a0<br/>\u00a0\u00a0 \u00a0 return result;<br/></div></div>",
        "post_num": 44,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "satoshi",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=3",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg5769#msg5769",
        "date": "July 25, 2010, 09:44:16 PM",
        "content": "<div class=\"post\"><div class=\"quoteheader\"><a href=\"https://bitcointalk.org/index.php?topic=461.msg5753#msg5753\">Quote from: BitLex on July 25, 2010, 08:45:38 PM</a></div><div class=\"quote\">i got some problems here too trying to get this run on PHP.<br/>so far i had no luck, neither the wiki-sample (jsonRPCClient trying to fopen(<a href=\"http://username:password@localhost:8332/\">http://username:password@localhost:8332/</a>)), nor my curl-sample (using setopt CURLOPT_HTTPAUTH, CURLAUTH_BASIC) seem to work.<br/></div>That's strange, didn't someone just say that was supposed to work? \u00a0(what library was he using?) \u00a0Post if you figure out what wrong.<br/><br/>I hope it's not going to put up this much of a fight for all PHP users.<br/><br/>Looks like we've got the Fortran scenario already. </div>",
        "post_num": 45,
        "is_displayed": true,
        "nested_level": 0
    },
    {
        "thread_id": 123,
        "name": "satoshi",
        "poster_url": "https://bitcointalk.org/index.php?action=profile;u=3",
        "subject": "Re: JSON-RPC password",
        "url": "https://bitcointalk.org/index.php?topic=461.msg5771#msg5771",
        "date": "July 25, 2010, 09:51:31 PM",
        "content": "<div class=\"post\"><div class=\"quoteheader\"><a href=\"https://bitcointalk.org/index.php?topic=461.msg5768#msg5768\">Quote from: gavinandresen on July 25, 2010, 09:38:19 PM</a></div><div class=\"quote\">Great catch! \u00a0Simpler fix is to specify the BIO_FLAGS_BASE64_NO_NL in the rpc.cpp/EncodeBase64 function<br/></div>SVN rev 111</div>",
        "post_num": 46,
        "is_displayed": true,
        "nested_level": 0
    }
]